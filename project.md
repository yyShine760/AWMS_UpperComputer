# 高空攀爬状态下安全预警及监控系统

---

### 项目描述  
我开发了一套完整的高空作业安全监控系统，包括上位机和下位机项目。上位机是一个基于Qt的桌面应用程序，专注于装备管理和安全监控，通过读取和写入JSON文件来存储和加载装备信息，提供直观的图形用户界面供用户操作。下位机则使用STM32F303和CORE-AIR780模块与上位机进行远程通信，监控安全帽和安全带的状态。

### 项目要点  
在上位机项目中，我实现了装备的增删改查功能，支持通过装备编号和员工姓名进行搜索。用户界面以QTableWidget为核心，布局合理，用户可以轻松进行操作。多线程技术用于独立监听下位机发送的信号，实时更新安全帽和安全带的状态。此外，通过StringPoolUtil类统一管理字符串资源，支持国际化。下位机项目中，STM32F303和CORE-AIR780模块负责与上位机的通信，监控安全装备状态，在未佩戴好的情况下触发报警并发送警告信息至上位机。下位机还能够接收上位机命令，关闭报警、进行远程语音通话，并使用低功耗模式以延长续航时间。

### 项目收获  
通过开发这一系统，我全面提升了对Qt框架、多线程处理、嵌入式开发和上下位机的理解。此外我熟悉了从设备监控到用户界面的完整系统集成过程，在项目中积累了丰富的实践经验。

## UI界面事件

- 信息输出功能：可切换查看编号绑定下的员工信息及装备状态。
- 添加/删除功能：用户手动添加或删除非绑定状态下的装备编号。
- 绑定/解绑功能：用户双击已存在的装备编号可绑定到员工。员工归还装备后可以解除与员工绑定。
- 切换绑定装备的员工信息并实时显示佩戴装备的信息。
- 突发/取消事件功能：如果有未系戴好装备，界面将提示。可以手动取消提示。
- 通知员工：当突发事件触发时可远程通知员工系戴好装备。

## 技术架构

一、使用多线程单独监听下位机发送的信号。
二、使用JSON文件格式存储数据。

### 与下位机通信，当下位机发送未佩戴完全信号时







## 遇到的问题
1. 在jsonUtil中，getJson方法每次会读取一次文件，造成频繁操作文件的问题。

## 解决办法
1. 在jsonUtil中，getJson方法中，使用缓存机制，将读取到的json数据缓存起来，下次读取时直接从缓存中读取。只在必要时（如重新加载或保存时）打开和关闭文件。这样可以避免在每次访问 JSON 数据时都进行文件操作。

在类中添加一个布尔变量，用于跟踪 JSON 文件是否已被修改。
当写入文件时，更新缓存并设置修改标志。
在读取文件时，如果文件未被修改，则直接返回缓存的 JSON 对象；如果文件被修改，则重新加载文件内容并更新缓存。
